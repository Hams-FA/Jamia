<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<script  src="https://code.jquery.com/jquery-3.5.1.min.js" type="text/javascript"></script>

	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<title>Active list</title>
	<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

	<link rel="stylesheet"
		href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />


	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round">
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="style.css">

	<style>
        body {background-color :#c7d4c0;}
        #logo { float:right; margin:0; width:5%; height: 5%;}
        #navlist { float: left; }
    </style>
	<link rel="shortcut icon" href="logo3.jpg">

</head>

<body>
	<nav class="navbar navbar-expand-lg navbar-light bg-light">
        <img id="logo" src="logo3.jpg">
        <div class="container">
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul id = "navlist" class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                    <a href="JamiaDetails.html" class="nav-link">جمعيات </a>
                </li>
                <li class="nav-item">
                    <a href="jamias.html" class="nav-link">االتحويل الشهري</a>
                </li>
                <li class="nav-item">
                    <a href="userProfiles.html" class="nav-link">الأشخاص</a>
                </li>
                <li class="nav-item">
                    <a href="activation.html" class="nav-link">إدارة المستخدمين</a>
                </li>
				<li style = "float: right; "class="nav-item">
                    <a href="#" id="logout" class="nav-link">تسجيل خروج</a>
                </li>
                </ul>
            </div>
            </div>
          </nav>

	<div class="container-xl d-flex justify-content-center align-items-center p-5">
		<div class="table-wrapper">
			<div class="table-title">
				<div class="row">
					<div class="col-sm-6">
						<div style="background-image: 'wrap.jpg';">
							<h3 style="padding-left: 30px; text-align:right;"><h8 style = "padding-left: 30px; color:#0c7b0c">..............</h8>إدارة المستخدمين</h3>
						</div>
					</div>
					<!-- <div class="col-sm-6">
                    <a href="#addEmployeeModal" class="btn btn-success" data-toggle="modal"><i class="material-icons">&#xE147;</i> <span>Add New User</span></a>						
                </div> -->
				</div>
			</div>
			<table style="text-align:center;" id="t" class="table table-striped table-hover">
				<thead>
					<tr style="font-size: 24px;">
						<th class="test">تفعيل/توقيف</th>
						<th>البريد الإلكتروني</th>
						<th>الاسم</th>
					</tr>
				</thead>

			</table>
		</div>
	</div>
	<!-- Add Modal HTML -->
	<div id="addEmployeeModal" class="modal fade">
		<div class="modal-dialog">
			<div class="modal-content">
				<form>
					<div class="modal-header">
						<h4 class="modal-title">Add Employee</h4>
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
					</div>
					<div class="modal-body">
						<div class="form-group">
							<label>Name</label>
							<input type="text" class="form-control addName" required>
						</div>
						<div class="form-group">
							<label>Email</label>
							<input type="email" class="form-control addEmail" required>
						</div>
					</div>
					<div class="modal-footer">
						<input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">
						<input type="submit" class="btn btn-success addData" value="Add">
					</div>
				</form>
			</div>
		</div>
	</div>
	<!-- Edit Modal HTML -->
	<div id="editEmployeeModal" class="modal fade">
		<div class="modal-dialog">
			<div class="modal-content">
				<form>
					<div class="modal-header">
						<h4 class="modal-title">Edit Employee</h4>
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
					</div>
					<div class="modal-body">
						<div class="form-group">
							<label>Name</label>
							<input type="text" class="form-control" required>
						</div>
						<div class="form-group">
							<label>Email</label>
							<input type="email" class="form-control" required>
						</div>
					</div>
					<div class="modal-footer">
						<input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">
						<input type="submit" class="btn btn-info" value="Save">
					</div>
				</form>
			</div>
		</div>
	</div>
	<!-- Delete Modal HTML -->
	<div id="deleteEmployeeModal" class="modal fade">
		<div class="modal-dialog">
			<div class="modal-content">
				<form>
					<div class="modal-header">
						<h4 class="modal-title">Delete Employee</h4>
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
					</div>
					<div class="modal-body">
						<p>Are you sure you want to delete these Records?</p>
						<p class="text-warning"><small>This action cannot be undone.</small></p>
					</div>
					<div class="modal-footer">
						<input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">
						<input type="submit" class="btn btn-danger" value="Delete">
					</div>
				</form>
			</div>
		</div>
	</div>
	<script>
		// function myFunc(y) {
			

		// 	y.classList.toggle("fa-thumbs-up");
		// }

		// function myFunction(x) {

		// 	x.classList.toggle("fa-thumbs-down");

		// 	// if (x.classList.value == "fa fa-thumbs-up") {
		// 	// 	// doc.update({status : 1});
		// 	// 	updateDoc(doc, { "status": 1 });
		// 	// 	console.log(doc.data().status + "l1");
		// 	// 	x.classList.toggle("fa-thumbs-down");
		// 	// }

		// 	// else if (x.classList.value == "fa fa-thumbs-down") {
		// 	// 	console.log(x.classList.value + 2);

		// 	// 	x.classList.toggle("fa-thumbs-up");
		// 	// 	updateDoc(doc, { "status": 1 });

		// 	// }
		// }
	</script>
	<!-- <script>

		function myFunction(x) {
			if(x.classList.value == "fa fa-thumbs-up"){
				console.log(x.classList.value + "1")

				x.classList.toggle("fa-thumbs-down");}
			else if(x.classList.value == "fa fa-thumbs-down"){
				console.log(x.classList.value + 2)

				x.classList.toggle("fa-thumbs-up");}

		}
	</script> -->



	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script> 
	<script type="module">
		// Import the functions you need from the SDKs you need
		import { initializeApp } from "https://www.gstatic.com/firebasejs/9.11.0/firebase-app.js";
		import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.11.0/firebase-analytics.js";
		import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/9.11.0/firebase-firestore.js";
		import { doc, updateDoc } from "https://www.gstatic.com/firebasejs/9.11.0/firebase-firestore.js";



		// TODO: Add SDKs for Firebase products that you want to use
		// https://firebase.google.com/docs/web/setup#available-libraries

		// Your web app's Firebase configuration
		// For Firebase JS SDK v7.20.0 and later, measurementId is optional
		// For Firebase JS SDK v7.20.0 and later, measurementId is optional
		const firebaseConfig = {
			apiKey: "AIzaSyAPD2rLWY3Nvbs3cW19-SkCQ7NtfeIr_xk",
			authDomain: "jamia-2bcc1.firebaseapp.com",
			projectId: "jamia-2bcc1",
			storageBucket: "jamia-2bcc1.appspot.com",
			messagingSenderId: "585806474023",
			appId: "1:585806474023:web:e98bb5c8e5e1472f4c1702",
			measurementId: "G-45VRZZ51WF"
		};


		// Initialize Firebase
		const app = initializeApp(firebaseConfig);
		const analytics = getAnalytics(app);
		// Initialize Cloud Firestore and get a reference to the service
		const db = getFirestore(app);
		const querySnapshot = await getDocs(collection(db, "users"));

	
		querySnapshot.docs.forEach((doc1) => {
			var nowstatus = doc1.data().status;
			const frankDocRef = doc(db, "users", doc1.data().Email);

			var table = document.getElementById("t");
			var row = table.insertRow(1);
			var cell1 = row.insertCell(0);
			var cell2 = row.insertCell(1);
			var cell3 = row.insertCell(2);
			row.setAttribute('data-status', doc1.data().status);
			row.setAttribute('data-email', doc1.data().Email);

			// row.setAttribute('data-email', JSON.stringify(frankDocRef));
			cell3.innerHTML = " " + doc1.data().fname + " " + doc1.data().lname;
			cell2.innerHTML =  doc1.data().Email;
			if (nowstatus == 1) {

				cell1.innerHTML = '<button style="background-color: green;" class="  btn btn-success addData" ><b>تفعيل</b></button>';
			} else {
				cell1.innerHTML = '<button style="background-color: red;" class=" btn btn-success addData " ><b>توقيف</b></button>';
			}
			// function render(){
			// 	const frankDocRef = doc(db, "users", doc1.data().Email);
			// 	return frankDocRef;

			// }

		});

		$(".addData").on("click",(e)=> {
			var txt;
		  if (confirm("هل أنت متأكد من إيقاف الحساب؟")) {
						
			let id = e.target.parentElement.parentElement.getAttribute('data-status');
			let zid = e.target.parentElement.parentElement.getAttribute('data-email');	
						

			if(id == 0){
				 console.log(zid);
				 console.log("dd" +id);

				 e.target.parentElement.parentElement.setAttribute('data-status', 1 );
				 e.target.parentElement.parentElement.setAttribute('data-email', zid );
				 e.target.setAttribute('style',"background-color: green;"  );

				 updateDoc( doc(db, "users", zid), { "status": 1});




				 e.target.innerHTML= "تفعيل";




			}
			else{
				  console.log(zid);
				  console.log("dd" +id);

				 e.target.parentElement.parentElement.setAttribute('data-status', 0);
				 e.target.parentElement.parentElement.setAttribute('data-email', zid );
				 e.target.setAttribute('style',"background-color: red;"  );

				 updateDoc(doc(db, "users", zid), { "status": 0});


				 e.target.innerHTML= "توقيف";

			}






		  } else {
			console.log("cancel");
		  }
		}
			

		);
		// $(".addData").on("click",(e)=> {
			
			
		// // 	let id = e.target.parentElement.parentElement.getAttribute('data-status');
		// // 	let zid = e.target.parentElement.parentElement.getAttribute('data-email');
			

		// // 	if(id == 0){
		// // // // // // 		// db.collection('users').doc('zid').update({
		// // // // // // 		// 	"status": 1
		// // // // // // 		// });
		// // 		 updateDoc(JSON.parse(zid) , { "status": 1});
		// // 		 console.log("tst0");

		// // 	}
		// // 	else{
		// // 		updateDoc(JSON.parse(zid), { "status": 0});
		// // 		 console.log("tst1");
		// // // // // 		// db.collection('users').doc('zid').update({
		// // // // // 		// 	"status": 0
		// // // // // 		// });

		// // // 		updateDoc(zid, { "status": 1 });
		// // 	}
		// // });

		// // // querySnapshot.docs.forEach((doc) => {

		
		// });

			// if (x.classList.value == "mm btn btn-success addData") {
			// 	// doc.update({status : 1});
			// 	updateDoc(doc, { "status": 0 });
			// 	console.log(doc.data().status + "l1");
			// 	// x.classList.toggle("fa-thumbs-up");
			// }

			// else if (x.classList.value == "mm2 btn btn-success addData") {
			// 	console.log(doc.data().status + "l2");

			// 	// x.classList.toggle("fa-thumbs-up");
			// 	updateDoc(doc, { "status": 1 });

			// }
	</script>
	// <script>
	// 	function myFunction() {
	// 	  var txt;
	// 	  if (confirm("Press a button!")) {
	// 		txt = "You pressed OK!";
	// 	  } else {
	// 		txt = "You pressed Cancel!";
	// 	  }
	// 	  document.getElementById("demo").innerHTML = txt;
	// 	}
	// 	</script>
	<!-- <script src="app.js"></script> -->
</body>

</html>